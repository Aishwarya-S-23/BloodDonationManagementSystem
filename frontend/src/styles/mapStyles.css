/* Soft, desaturated map styling */
.leaflet-container {
  filter: grayscale(0.2) brightness(1.05) contrast(0.95);
  transition: filter 0.3s ease-out;
  z-index: 0;
}

/* Prevent double initialization issues */
.leaflet-container.leaflet-touch-zoom {
  -ms-touch-action: pan-x pan-y;
  touch-action: pan-x pan-y;
}

/* Fix for _leaflet_pos error */
.leaflet-pane {
  z-index: 400;
}

.leaflet-tile-pane {
  z-index: 200;
}

.leaflet-overlay-pane {
  z-index: 400;
}

.leaflet-shadow-pane {
  z-index: 500;
}

.leaflet-marker-pane {
  z-index: 600;
}

.leaflet-tooltip-pane {
  z-index: 650;
}

.leaflet-popup-pane {
  z-index: 700;
}

/* Ensure map tiles have soft appearance */
.leaflet-tile-container img {
  filter: grayscale(0.15) brightness(1.08);
}

/* Soft map controls */
.leaflet-control-zoom {
  border: none !important;
  box-shadow: 0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04) !important;
  border-radius: 12px !important;
  overflow: hidden;
}

.leaflet-control-zoom a {
  background-color: white !important;
  color: #64748b !important;
  border: none !important;
  transition: all 0.2s ease-out;
}

.leaflet-control-zoom a:hover {
  background-color: #f1f5f9 !important;
  color: #475569 !important;
}

.leaflet-control-zoom-in,
.leaflet-control-zoom-out {
  font-size: 18px !important;
  line-height: 30px !important;
}

/* Soft popup styling */
.leaflet-popup-content-wrapper {
  border-radius: 12px !important;
  box-shadow: 0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04) !important;
  border: 1px solid rgba(226, 232, 240, 0.8) !important;
}

.leaflet-popup-tip {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
}

/* Marker hover effect */
.leaflet-marker-icon {
  transition: transform 0.2s ease-out, filter 0.2s ease-out;
}

.leaflet-marker-icon:hover {
  transform: scale(1.15);
  filter: brightness(1.1);
  z-index: 1000 !important;
}

/* Map container with soft appearance */
.map-container-soft {
  border-radius: 1rem;
  overflow: hidden;
  border: 1px solid rgba(226, 232, 240, 0.8);
}

/* Accessibility: Ensure map is keyboard navigable */
.leaflet-container:focus {
  outline: 2px solid #BC2F3C;
  outline-offset: 2px;
}
